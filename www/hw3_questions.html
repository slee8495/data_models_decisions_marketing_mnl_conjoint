<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.506">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sangho Lee">
<meta name="dcterms.date" content="2024-05-13">

<title>hw3_questions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw3_questions_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw3_questions_files/libs/quarto-html/quarto.js"></script>
<script src="hw3_questions_files/libs/quarto-html/popper.min.js"></script>
<script src="hw3_questions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw3_questions_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw3_questions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw3_questions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw3_questions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw3_questions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw3_questions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sangho Lee </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>This assignment uses uses the MNL model to analyze (1) yogurt purchase data made by consumers at a retail location.</p>
<section id="estimating-yogurt-preferences" class="level2">
<h2 class="anchored" data-anchor-id="estimating-yogurt-preferences">1. Estimating Yogurt Preferences</h2>
<section id="likelihood-for-the-multi-nomial-logit-mnl-model" class="level3">
<h3 class="anchored" data-anchor-id="likelihood-for-the-multi-nomial-logit-mnl-model">Likelihood for the Multi-nomial Logit (MNL) Model</h3>
<p>Suppose we have <span class="math inline">\(i=1,\ldots,n\)</span> consumers who each select exactly one product <span class="math inline">\(j\)</span> from a set of <span class="math inline">\(J\)</span> products. The outcome variable is the identity of the product chosen <span class="math inline">\(y_i \in \{1, \ldots, J\}\)</span> or equivalently a vector of <span class="math inline">\(J-1\)</span> zeros and <span class="math inline">\(1\)</span> one, where the <span class="math inline">\(1\)</span> indicates the selected product. For example, if the third product was chosen out of 4 products, then either <span class="math inline">\(y=3\)</span> or <span class="math inline">\(y=(0,0,1,0)\)</span> depending on how we want to represent it. Suppose also that we have a vector of data on each product <span class="math inline">\(x_j\)</span> (eg, size, price, etc.).</p>
<p>We model the consumer’s decision as the selection of the product that provides the most utility, and we’ll specify the utility function as a linear function of the product characteristics:</p>
<p><span class="math display">\[ U_{ij} = x_j'\beta + \epsilon_{ij} \]</span></p>
<p>where <span class="math inline">\(\epsilon_{ij}\)</span> is an i.i.d. extreme value error term.</p>
<p>The choice of the i.i.d. extreme value error term leads to a closed-form expression for the probability that consumer <span class="math inline">\(i\)</span> chooses product <span class="math inline">\(j\)</span>:</p>
<p><span class="math display">\[ \mathbb{P}_i(j) = \frac{e^{x_j'\beta}}{\sum_{k=1}^Je^{x_k'\beta}} \]</span></p>
<p>For example, if there are 4 products, the probability that consumer <span class="math inline">\(i\)</span> chooses product 3 is:</p>
<p><span class="math display">\[ \mathbb{P}_i(3) = \frac{e^{x_3'\beta}}{e^{x_1'\beta} + e^{x_2'\beta} + e^{x_3'\beta} + e^{x_4'\beta}} \]</span></p>
<p>A clever way to write the individual likelihood function for consumer <span class="math inline">\(i\)</span> is the product of the <span class="math inline">\(J\)</span> probabilities, each raised to the power of an indicator variable (<span class="math inline">\(\delta_{ij}\)</span>) that indicates the chosen product:</p>
<p><span class="math display">\[ L_i(\beta) = \prod_{j=1}^J \mathbb{P}_i(j)^{\delta_{ij}} = \mathbb{P}_i(1)^{\delta_{i1}} \times \ldots \times \mathbb{P}_i(J)^{\delta_{iJ}}\]</span></p>
<p>Notice that if the consumer selected product <span class="math inline">\(j=3\)</span>, then <span class="math inline">\(\delta_{i3}=1\)</span> while <span class="math inline">\(\delta_{i1}=\delta_{i2}=\delta_{i4}=0\)</span> and the likelihood is:</p>
<p><span class="math display">\[ L_i(\beta) = \mathbb{P}_i(1)^0 \times \mathbb{P}_i(2)^0 \times \mathbb{P}_i(3)^1 \times \mathbb{P}_i(4)^0 = \mathbb{P}_i(3) = \frac{e^{x_3'\beta}}{\sum_{k=1}^Je^{x_k'\beta}} \]</span></p>
<p>The joint likelihood (across all consumers) is the product of the <span class="math inline">\(n\)</span> individual likelihoods:</p>
<p><span class="math display">\[ L_n(\beta) = \prod_{i=1}^n L_i(\beta) = \prod_{i=1}^n \prod_{j=1}^J \mathbb{P}_i(j)^{\delta_{ij}} \]</span></p>
<p>And the joint log-likelihood function is:</p>
<p><span class="math display">\[ \ell_n(\beta) = \sum_{i=1}^n \sum_{j=1}^J \delta_{ij} \log(\mathbb{P}_i(j)) \]</span></p>
</section>
<section id="yogurt-dataset" class="level3">
<h3 class="anchored" data-anchor-id="yogurt-dataset">Yogurt Dataset</h3>
</section>
<section id="we-will-use-the-yogurt_data-dataset-which-provides-anonymized-consumer-identifiers-id-a-vector-indicating-the-chosen-product-y1y4-a-vector-indicating-if-any-products-were-featured-in-the-store-as-a-form-of-advertising-f1f4-and-the-products-prices-p1p4.-for-example-consumer-1-purchased-yogurt-4-at-a-price-of-0.079oz-and-none-of-the-yogurts-were-featuredadvertised-at-the-time-of-consumer-1s-purchase.-consumers-2-through-7-each-bought-yogurt-2-etc." class="level3">
<h3 class="anchored" data-anchor-id="we-will-use-the-yogurt_data-dataset-which-provides-anonymized-consumer-identifiers-id-a-vector-indicating-the-chosen-product-y1y4-a-vector-indicating-if-any-products-were-featured-in-the-store-as-a-form-of-advertising-f1f4-and-the-products-prices-p1p4.-for-example-consumer-1-purchased-yogurt-4-at-a-price-of-0.079oz-and-none-of-the-yogurts-were-featuredadvertised-at-the-time-of-consumer-1s-purchase.-consumers-2-through-7-each-bought-yogurt-2-etc.">We will use the <code>yogurt_data</code> dataset, which provides anonymized consumer identifiers (<code>id</code>), a vector indicating the chosen product (<code>y1</code>:<code>y4</code>), a vector indicating if any products were “featured” in the store as a form of advertising (<code>f1</code>:<code>f4</code>), and the products’ prices (<code>p1</code>:<code>p4</code>). For example, consumer 1 purchased yogurt 4 at a price of 0.079/oz and none of the yogurts were featured/advertised at the time of consumer 1’s purchase. Consumers 2 through 7 each bought yogurt 2, etc.</h3>
</section>
<section id="i-will-begin-by-importing-the-dataset-and-displaying-the-first-few-rows-to-understand-its-structure.-following-this-i-will-provide-a-brief-overview-of-the-dataset-highlighting-key-features-data-types-and-any-potential-issues-that-may-require-further-exploration-or-cleaning." class="level3">
<h3 class="anchored" data-anchor-id="i-will-begin-by-importing-the-dataset-and-displaying-the-first-few-rows-to-understand-its-structure.-following-this-i-will-provide-a-brief-overview-of-the-dataset-highlighting-key-features-data-types-and-any-potential-issues-that-may-require-further-exploration-or-cleaning.">I will begin by importing the dataset and displaying the first few rows to understand its structure. Following this, I will provide a brief overview of the dataset, highlighting key features, data types, and any potential issues that may require further exploration or cleaning.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyrsm <span class="im">as</span> rsm</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>yogurt_data <span class="op">=</span> pd.read_csv(<span class="st">"yogurt_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>yogurt_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"yogurt_data.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>yogurt_data <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">y1</th>
<th style="text-align: right;">y2</th>
<th style="text-align: right;">y3</th>
<th style="text-align: right;">y4</th>
<th style="text-align: right;">f1</th>
<th style="text-align: right;">f2</th>
<th style="text-align: right;">f3</th>
<th style="text-align: right;">f4</th>
<th style="text-align: right;">p1</th>
<th style="text-align: right;">p2</th>
<th style="text-align: right;">p3</th>
<th style="text-align: right;">p4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.079</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.075</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.086</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.086</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.079</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.079</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.103</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.079</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">0.079</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.079</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.079</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="data-explanation" class="level3">
<h3 class="anchored" data-anchor-id="data-explanation">Data Explanation</h3>
<section id="column-descriptions" class="level4">
<h4 class="anchored" data-anchor-id="column-descriptions">Column Descriptions:</h4>
<ul>
<li>id: A unique identifier for each consumer.</li>
<li>y1 to y4: Binary indicators where 1 represents the chosen product among four options (each column corresponds to a product).</li>
<li>f1 to f4: Binary indicators for whether the product was featured or not.</li>
<li>p1 to p4: Prices of the four products.</li>
</ul>
</section>
<section id="statistical-summary" class="level4">
<h4 class="anchored" data-anchor-id="statistical-summary">Statistical Summary:</h4>
<ul>
<li>The y columns show a varied distribution among the products, with some having a higher selection frequency, suggesting preference differences among consumers.</li>
<li>The f columns indicate relatively few promotions for any given product, which could influence model results, especially in understanding the impact of promotions on product choice.</li>
<li>The p columns have a range of prices which will be critical for understanding how price sensitivity affects consumer choice.</li>
</ul>
</section>
<section id="key-insights" class="level4">
<h4 class="anchored" data-anchor-id="key-insights">Key Insights:</h4>
<ul>
<li>Consumer Choices: The distribution of choices (y columns) can help determine product popularity and preference. This will be essential for the MNL model where product choice is the dependent variable.</li>
<li>Promotion Impact: The f columns will help analyze the effect of promotions on consumer choice, useful for determining if promotions lead to higher product selection.</li>
<li>Price Sensitivity: The p columns are crucial for analyzing how price changes impact consumer choice, which is fundamental for modeling utility in the MNL model.</li>
</ul>
<p><br><br></p>
</section>
<section id="i-will-perform-exploratory-data-analysis-eda-to-understand-the-format-and-characteristics-of-the-dataset.-this-involves-examining-the-structure-summary-statistics-distributions-and-relationships-within-the-data-allowing-us-to-identify-any-patterns-anomalies-or-potential-issues-that-may-inform-subsequent-analyses." class="level4">
<h4 class="anchored" data-anchor-id="i-will-perform-exploratory-data-analysis-eda-to-understand-the-format-and-characteristics-of-the-dataset.-this-involves-examining-the-structure-summary-statistics-distributions-and-relationships-within-the-data-allowing-us-to-identify-any-patterns-anomalies-or-potential-issues-that-may-inform-subsequent-analyses.">I will perform exploratory data analysis (EDA) to understand the format and characteristics of the dataset. This involves examining the structure, summary statistics, distributions, and relationships within the data, allowing us to identify any patterns, anomalies, or potential issues that may inform subsequent analyses.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(yogurt_data.info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2430 entries, 0 to 2429
Data columns (total 13 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   id      2430 non-null   int64  
 1   y1      2430 non-null   int64  
 2   y2      2430 non-null   int64  
 3   y3      2430 non-null   int64  
 4   y4      2430 non-null   int64  
 5   f1      2430 non-null   int64  
 6   f2      2430 non-null   int64  
 7   f3      2430 non-null   int64  
 8   f4      2430 non-null   int64  
 9   p1      2430 non-null   float64
 10  p2      2430 non-null   float64
 11  p3      2430 non-null   float64
 12  p4      2430 non-null   float64
dtypes: float64(4), int64(9)
memory usage: 246.9 KB
None</code></pre>
</div>
</div>
</section>
<section id="dataset-overview" class="level4">
<h4 class="anchored" data-anchor-id="dataset-overview">Dataset Overview</h4>
<ul>
<li>The dataset contains 2430 observations across 13 columns.</li>
<li>There are no missing values in any of the columns, indicating a clean and complete dataset ready for analysis.</li>
</ul>
<p><br></p>
</section>
<section id="bivariate-analysis-price-vs-choice" class="level4">
<h4 class="anchored" data-anchor-id="bivariate-analysis-price-vs-choice">Bivariate Analysis: Price vs Choice</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>melted_yogurt_data <span class="op">=</span> pd.melt(yogurt_data, id_vars<span class="op">=</span>[<span class="st">'id'</span>], value_vars<span class="op">=</span>[<span class="st">'y1'</span>, <span class="st">'y2'</span>, <span class="st">'y3'</span>, <span class="st">'y4'</span>], </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                             var_name<span class="op">=</span><span class="st">'choice'</span>, value_name<span class="op">=</span><span class="st">'chosen'</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>chosen_data <span class="op">=</span> melted_yogurt_data[melted_yogurt_data[<span class="st">'chosen'</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>chosen_data <span class="op">=</span> chosen_data.merge(yogurt_data[[<span class="st">'id'</span>, <span class="st">'p1'</span>, <span class="st">'p2'</span>, <span class="st">'p3'</span>, <span class="st">'p4'</span>]], on<span class="op">=</span><span class="st">'id'</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_price(row):</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row[<span class="st">'choice'</span>] <span class="op">==</span> <span class="st">'y1'</span>:</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> row[<span class="st">'p1'</span>]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'choice'</span>] <span class="op">==</span> <span class="st">'y2'</span>:</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> row[<span class="st">'p2'</span>]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'choice'</span>] <span class="op">==</span> <span class="st">'y3'</span>:</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> row[<span class="st">'p3'</span>]</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'choice'</span>] <span class="op">==</span> <span class="st">'y4'</span>:</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> row[<span class="st">'p4'</span>]</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>chosen_data[<span class="st">'price'</span>] <span class="op">=</span> chosen_data.<span class="bu">apply</span>(get_price, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'choice'</span>, y<span class="op">=</span><span class="st">'price'</span>, data<span class="op">=</span>chosen_data)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Price Distribution for Each Chosen Yogurt Type'</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Yogurt Type'</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price'</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw3_questions_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation:</h4>
<ul>
<li><p>Yogurt 1 (y1): This yogurt shows a wide range of prices, with the majority concentrated around the higher end, as indicated by the dense cluster of outliers at the lower price range. The median price is just below $0.10 per oz. The box extends from around $0.05 to over $0.10, indicating a broad spread in prices for this choice.</p></li>
<li><p>Yogurt 2 (y2): The price distribution for Yogurt 2 is relatively compact compared to Yogurt 1, suggesting less variability in its pricing. The median price is close to $0.09 per oz. The box is narrow, centered around this median, with fewer outliers, which indicates more consistent pricing for this yogurt.</p></li>
<li><p>Yogurt 3 (y3): Yogurt 3 shows a median price roughly at $0.06 per oz. The box is moderately wide, showing some variation in price but less so than Yogurt 1. There are a few outliers on the higher side, but overall, the distribution suggests moderate price consistency.</p></li>
<li><p>Yogurt 4 (y4): Similar to Yogurt 3, the price distribution for Yogurt 4 is centered around $0.08 per oz, with a relatively narrow box indicating consistent pricing. This choice exhibits fewer outliers, suggesting that the prices for Yogurt 4 are quite stable.</p></li>
</ul>
</section>
<section id="future-simulation-plans-given-the-insights-from-the-current-price-distribution-analysis-of-the-different-yogurt-types-a-logical-next-step-is-to-simulate-how-changes-in-pricing-could-potentially-affect-consumer-choices.-this-simulation-would-provide-valuable-insights-into-the-price-elasticity-of-each-yogurt-type-and-help-optimize-pricing-strategies." class="level4">
<h4 class="anchored" data-anchor-id="future-simulation-plans-given-the-insights-from-the-current-price-distribution-analysis-of-the-different-yogurt-types-a-logical-next-step-is-to-simulate-how-changes-in-pricing-could-potentially-affect-consumer-choices.-this-simulation-would-provide-valuable-insights-into-the-price-elasticity-of-each-yogurt-type-and-help-optimize-pricing-strategies.">Future Simulation Plans: Given the insights from the current price distribution analysis of the different yogurt types, a logical next step is to simulate how changes in pricing could potentially affect consumer choices. This simulation would provide valuable insights into the price elasticity of each yogurt type and help optimize pricing strategies.</h4>
</section>
<section id="price-increase-simulation-initially-focus-on-simulating-the-effects-of-a-moderate-price-increase-particularly-for-yogurt-1-which-exhibits-the-highest-price-variability.-the-aim-would-be-to-determine-if-a-higher-price-could-be-sustained-without-significant-loss-of-market-share-given-its-apparent-premium-positioning." class="level4">
<h4 class="anchored" data-anchor-id="price-increase-simulation-initially-focus-on-simulating-the-effects-of-a-moderate-price-increase-particularly-for-yogurt-1-which-exhibits-the-highest-price-variability.-the-aim-would-be-to-determine-if-a-higher-price-could-be-sustained-without-significant-loss-of-market-share-given-its-apparent-premium-positioning.">Price Increase Simulation: Initially focus on simulating the effects of a moderate price increase, particularly for Yogurt 1, which exhibits the highest price variability. The aim would be to determine if a higher price could be sustained without significant loss of market share, given its apparent premium positioning.</h4>
<p><br><br></p>
<p>Let the vector of product features include brand dummy variables for yogurts 1-3 (we’ll omit a dummy for product 4 to avoid multi-collinearity), a dummy variable to indicate if a yogurt was featured, and a continuous variable for the yogurts’ prices:</p>
<p><span class="math display">\[ x'_j = \left[ \mathbb{1}(\text{Yogurt 1}), \mathbb{1}(\text{Yogurt 2}), \mathbb{1}(\text{Yogurt 3}), X_f, X_p \right] \]</span></p>
</section>
<section id="the-hard-part-of-the-mnl-likelihood-function-is-organizing-the-data-as-we-need-to-keep-track-of-3-dimensions-consumer-i-covariate-k-and-product-j-instead-of-the-typical-2-dimensions-for-cross-sectional-regression-models-consumer-i-and-covariate-k." class="level4">
<h4 class="anchored" data-anchor-id="the-hard-part-of-the-mnl-likelihood-function-is-organizing-the-data-as-we-need-to-keep-track-of-3-dimensions-consumer-i-covariate-k-and-product-j-instead-of-the-typical-2-dimensions-for-cross-sectional-regression-models-consumer-i-and-covariate-k.">The “hard part” of the MNL likelihood function is organizing the data, as we need to keep track of 3 dimensions (consumer <span class="math inline">\(i\)</span>, covariate <span class="math inline">\(k\)</span>, and product <span class="math inline">\(j\)</span>) instead of the typical 2 dimensions for cross-sectional regression models (consumer <span class="math inline">\(i\)</span> and covariate <span class="math inline">\(k\)</span>).</h4>
</section>
<section id="what-we-would-like-to-do-is-reorganize-the-data-from-a-wide-shape-with-n-rows-and-multiple-columns-for-each-covariate-to-a-long-shape-with-n-times-j-rows-and-a-single-column-for-each-covariate.-as-part-of-this-re-organization-well-add-binary-variables-to-indicate-the-first-3-products-the-variables-for-featured-and-price-are-included-in-the-dataset-and-simply-need-to-be-pivoted-or-melted-from-wide-to-long." class="level4">
<h4 class="anchored" data-anchor-id="what-we-would-like-to-do-is-reorganize-the-data-from-a-wide-shape-with-n-rows-and-multiple-columns-for-each-covariate-to-a-long-shape-with-n-times-j-rows-and-a-single-column-for-each-covariate.-as-part-of-this-re-organization-well-add-binary-variables-to-indicate-the-first-3-products-the-variables-for-featured-and-price-are-included-in-the-dataset-and-simply-need-to-be-pivoted-or-melted-from-wide-to-long.">What we would like to do is reorganize the data from a “wide” shape with <span class="math inline">\(n\)</span> rows and multiple columns for each covariate, to a “long” shape with <span class="math inline">\(n \times J\)</span> rows and a single column for each covariate. As part of this re-organization, we’ll add binary variables to indicate the first 3 products; the variables for featured and price are included in the dataset and simply need to be “pivoted” or “melted” from wide to long.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the choice data from wide to long format</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>choice_long <span class="ot">&lt;-</span> yogurt_data <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"y"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"product"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_prefix =</span> <span class="st">"y"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"choice"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">product =</span> <span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"y"</span>, <span class="st">""</span>, product)))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>choice_long <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">f1</th>
<th style="text-align: right;">f2</th>
<th style="text-align: right;">f3</th>
<th style="text-align: right;">f4</th>
<th style="text-align: right;">p1</th>
<th style="text-align: right;">p2</th>
<th style="text-align: right;">p3</th>
<th style="text-align: right;">p4</th>
<th style="text-align: right;">product</th>
<th style="text-align: right;">choice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the featured data from wide to long format</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>featured_long <span class="ot">&lt;-</span> yogurt_data <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"f"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"product"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_prefix =</span> <span class="st">"f"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"featured"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">product =</span> <span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"f"</span>, <span class="st">""</span>, product)))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>choice_long <span class="sc">%&gt;%</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">f1</th>
<th style="text-align: right;">f2</th>
<th style="text-align: right;">f3</th>
<th style="text-align: right;">f4</th>
<th style="text-align: right;">p1</th>
<th style="text-align: right;">p2</th>
<th style="text-align: right;">p3</th>
<th style="text-align: right;">p4</th>
<th style="text-align: right;">product</th>
<th style="text-align: right;">choice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the price data from wide to long format</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>price_long <span class="ot">&lt;-</span> yogurt_data <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"p"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"product"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_prefix =</span> <span class="st">"p"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">product =</span> <span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"p"</span>, <span class="st">""</span>, product)))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>yogurt_long <span class="ot">&lt;-</span> choice_long <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(featured_long, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"product"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(price_long, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"product"</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>yogurt_long <span class="ot">&lt;-</span> yogurt_long <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">is_brand1 =</span> <span class="fu">as.integer</span>(product <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">is_brand2 =</span> <span class="fu">as.integer</span>(product <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">is_brand3 =</span> <span class="fu">as.integer</span>(product <span class="sc">==</span> <span class="dv">3</span>))</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>yogurt_long <span class="ot">&lt;-</span> yogurt_long <span class="sc">%&gt;%</span> </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, product, choice, featured, price, is_brand1, is_brand2, is_brand3)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>yogurt_long <span class="sc">%&gt;%</span> </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">product</th>
<th style="text-align: right;">choice</th>
<th style="text-align: right;">featured</th>
<th style="text-align: right;">price</th>
<th style="text-align: right;">is_brand1</th>
<th style="text-align: right;">is_brand2</th>
<th style="text-align: right;">is_brand3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This code will ensure the dataset is structured correctly for your MNL model analysis, adhering strictly to the specified requirements.</p>
<p><br><br></p>
</section>
</section>
<section id="estimation" class="level3">
<h3 class="anchored" data-anchor-id="estimation">Estimation</h3>
<section id="i-will-now-code-the-log-likelihood-function-which-is-crucial-for-estimating-the-parameters-of-the-model.-this-function-will-be-used-to-quantify-the-fit-of-the-model-to-the-observed-data-facilitating-the-optimization-process." class="level4">
<h4 class="anchored" data-anchor-id="i-will-now-code-the-log-likelihood-function-which-is-crucial-for-estimating-the-parameters-of-the-model.-this-function-will-be-used-to-quantify-the-fit-of-the-model-to-the-observed-data-facilitating-the-optimization-process.">I will now code the log-likelihood function, which is crucial for estimating the parameters of the model. This function will be used to quantify the fit of the model to the observed data, facilitating the optimization process.</h4>
</section>
<section id="next-i-will-utilize-the-optim-function-in-r-to-determine-the-maximum-likelihood-estimates-mles-for-the-five-parameters-beta_1-beta_2-beta_3-beta_f-beta_p.-the-expected-results-should-include-meaningful-coefficients-for-the-product-intercepts-the-featured-variable-and-the-price-variable." class="level4">
<h4 class="anchored" data-anchor-id="next-i-will-utilize-the-optim-function-in-r-to-determine-the-maximum-likelihood-estimates-mles-for-the-five-parameters-beta_1-beta_2-beta_3-beta_f-beta_p.-the-expected-results-should-include-meaningful-coefficients-for-the-product-intercepts-the-featured-variable-and-the-price-variable.">Next, I will utilize the optim() function in R to determine the Maximum Likelihood Estimates (MLEs) for the five parameters (<span class="math inline">\(\beta_1, \beta_2, \beta_3, \beta_f, \beta_p\)</span>). The expected results should include meaningful coefficients for the product intercepts, the ‘featured’ variable, and the ‘price’ variable.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>log_likelihood_mnl <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, data) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[, <span class="fu">c</span>(<span class="st">"is_brand1"</span>, <span class="st">"is_brand2"</span>, <span class="st">"is_brand3"</span>, <span class="st">"featured"</span>, <span class="st">"price"</span>)])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  utility <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  exp_utility <span class="ot">&lt;-</span> <span class="fu">exp</span>(utility)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  sum_exp_utility <span class="ot">&lt;-</span> <span class="fu">ave</span>(exp_utility, data<span class="sc">$</span>id, <span class="at">FUN =</span> sum)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  probabilities <span class="ot">&lt;-</span> exp_utility <span class="sc">/</span> sum_exp_utility</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  log_likelihood <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>choice <span class="sc">*</span> <span class="fu">log</span>(probabilities <span class="sc">+</span> <span class="fl">1e-10</span>)) </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>log_likelihood)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>beta_initial <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimization to find the best beta values (MLE)</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>opt_result <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> beta_initial, <span class="at">fn =</span> log_likelihood_mnl, <span class="at">data =</span> yogurt_long, <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">trace =</span> <span class="dv">1</span>, <span class="at">REPORT =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>initial  value 3357.634432 
iter   2 value 2919.519024
iter   3 value 2908.708581
iter   4 value 2893.946481
iter   5 value 2891.773926
iter   6 value 2694.295659
iter   7 value 2665.521053
iter   8 value 2659.794403
iter   9 value 2659.096257
iter  10 value 2658.724608
iter  11 value 2658.580873
iter  12 value 2658.558266
iter  13 value 2658.558183
iter  13 value 2658.558149
iter  13 value 2658.558142
final  value 2658.558142 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(opt_result<span class="sc">$</span>par)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   1.3914204   0.6436796  -3.0902270   0.4860207 -37.1865574</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(opt_result<span class="sc">$</span>value)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2658.558</code></pre>
</div>
</div>
<p><br></p>
</section>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<section id="i-will-interpret-the-three-product-intercepts-to-determine-which-yogurt-is-most-preferred.-this-analysis-will-reveal-the-relative-popularity-of-each-yogurt-product-based-on-the-estimated-intercepts-allowing-us-to-identify-the-most-preferred-yogurt-among-the-options." class="level4">
<h4 class="anchored" data-anchor-id="i-will-interpret-the-three-product-intercepts-to-determine-which-yogurt-is-most-preferred.-this-analysis-will-reveal-the-relative-popularity-of-each-yogurt-product-based-on-the-estimated-intercepts-allowing-us-to-identify-the-most-preferred-yogurt-among-the-options.">I will interpret the three product intercepts to determine which yogurt is most preferred. This analysis will reveal the relative popularity of each yogurt product based on the estimated intercepts, allowing us to identify the most preferred yogurt among the options.</h4>
</section>
<section id="estimated-intercepts" class="level3">
<h3 class="anchored" data-anchor-id="estimated-intercepts">Estimated Intercepts:</h3>
<ul>
<li>β1 (Yogurt 1): 1.3914204</li>
<li>β2 (Yogurt 2): 0.6436796</li>
<li>β3 (Yogurt 3): -3.0902270</li>
</ul>
</section>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation:</h3>
<ul>
<li>The intercepts represent the baseline utility of each yogurt product when other factors (like being featured or price) are held constant. Higher intercepts indicate higher baseline preferences for the corresponding yogurt.</li>
</ul>
<ol type="1">
<li><p>Yogurt 1: Intercept (β1): 1.3914204 This is the highest positive value among the intercepts, indicating that Yogurt 1 has the highest baseline preference among consumers.</p></li>
<li><p>Yogurt 2: Intercept (β2): 0.6436796 This is positive but lower than the intercept for Yogurt 1, suggesting that Yogurt 2 is also preferred but not as much as Yogurt 1.</p></li>
<li><p>Yogurt 3: Intercept (β3): -3.0902270 This is a negative value, indicating that Yogurt 3 has the lowest baseline preference among the three yogurts. It is less preferred compared to Yogurt 1 and Yogurt 2.</p></li>
</ol>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion:</h3>
<ul>
<li>Most Preferred: Yogurt 1, with the highest intercept of 1.3914204, indicating it is the most preferred yogurt.</li>
<li>Second Most Preferred: Yogurt 2, with an intercept of 0.6436796.</li>
<li>Least Preferred: Yogurt 3, with a negative intercept of -3.0902270, indicating it is the least preferred yogurt.</li>
</ul>
<p><br><br></p>
<section id="i-will-use-the-estimated-price-coefficient-as-a-dollar-per-util-conversion-factor.-this-conversion-factor-will-allow-me-to-calculate-the-dollar-benefit-between-the-most-preferred-yogurt-the-one-with-the-highest-intercept-and-the-least-preferred-yogurt-the-one-with-the-lowest-intercept.-this-calculation-will-provide-a-per-unit-monetary-measure-of-brand-value-quantifying-the-financial-advantage-of-the-most-preferred-yogurt-over-the-least-preferred." class="level4">
<h4 class="anchored" data-anchor-id="i-will-use-the-estimated-price-coefficient-as-a-dollar-per-util-conversion-factor.-this-conversion-factor-will-allow-me-to-calculate-the-dollar-benefit-between-the-most-preferred-yogurt-the-one-with-the-highest-intercept-and-the-least-preferred-yogurt-the-one-with-the-lowest-intercept.-this-calculation-will-provide-a-per-unit-monetary-measure-of-brand-value-quantifying-the-financial-advantage-of-the-most-preferred-yogurt-over-the-least-preferred.">I will use the estimated price coefficient as a dollar-per-util conversion factor. This conversion factor will allow me to calculate the dollar benefit between the most preferred yogurt (the one with the highest intercept) and the least preferred yogurt (the one with the lowest intercept). This calculation will provide a per-unit monetary measure of brand value, quantifying the financial advantage of the most preferred yogurt over the least preferred.</h4>
</section>
</section>
<section id="monetary-measure-of-brand-value" class="level3">
<h3 class="anchored" data-anchor-id="monetary-measure-of-brand-value">Monetary Measure of Brand Value</h3>
<p>We can use the estimated price coefficient as a dollar-per-util conversion factor to calculate the dollar benefit between the most preferred and least preferred yogurts. This provides a per-unit monetary measure of brand value.</p>
<section id="step-1-establish-the-util-difference" class="level4">
<h4 class="anchored" data-anchor-id="step-1-establish-the-util-difference">Step 1: Establish the Util Difference</h4>
<p>The utility difference between the most preferred (Yogurt 1) and least preferred (Yogurt 3) yogurts is calculated as follows:</p>
<p><span class="math display">\[
\text{Util Difference} = \beta_1 - \beta_3 = 1.3914204 + 3.0902270 = 4.4816474
\]</span></p>
</section>
<section id="step-2-use-the-estimated-price-coefficient" class="level4">
<h4 class="anchored" data-anchor-id="step-2-use-the-estimated-price-coefficient">Step 2: Use the Estimated Price Coefficient</h4>
<p>The estimated price coefficient, (_p), is -37.1865574. This coefficient can be interpreted as the change in utility for each dollar increase in price per unit. Thus, the dollar-per-util conversion factor is the inverse of this coefficient:</p>
<p><span class="math display">\[ \text{Dollar-per-util} = \frac{1}{|\beta_p|} = \frac{1}{37.1865574} \approx 0.0269 \text{ dollars per util} \]</span></p>
</section>
<section id="step-3-calculate-the-dollar-benefit" class="level4">
<h4 class="anchored" data-anchor-id="step-3-calculate-the-dollar-benefit">Step 3: Calculate the Dollar Benefit</h4>
<p>The dollar benefit of the difference in utility between the most preferred and least preferred yogurts can be calculated as follows:</p>
<p><span class="math display">\[ \text{Dollar Benefit} = \text{Util Difference} \times \text{Dollar-per-util} = 4.4816474 \times 0.0269 \approx 0.12057 \text{ dollars} \]</span></p>
</section>
<section id="conclusion-1" class="level4">
<h4 class="anchored" data-anchor-id="conclusion-1">Conclusion</h4>
<p>The dollar benefit of approximately 12 cents represents the per-unit monetary measure of brand value between the most preferred yogurt (Yogurt 1) and the least preferred yogurt (Yogurt 3). This quantifies the premium that consumers might be willing to pay for Yogurt 1 over Yogurt 3 based on their utility differences derived from the Multinomial Logit model coefficients.</p>
<p><br><br></p>
</section>
<section id="lastly-i-will-calculate-the-market-shares-in-the-market-at-the-time-the-data-were-collected.-then-i-will-simulate-a-price-increase-for-yogurt-1-by-0.10-and-use-the-fitted-model-to-predict-the-choice-probabilities-pyx-for-each-consumer-and-each-product.-this-will-result-in-a-matrix-of-n-estimated-choice-probabilities.-by-taking-the-column-averages-i-will-determine-the-new-expected-market-shares-resulting-from-the-0.10-price-increase-to-yogurt-1-and-assess-whether-the-market-shares-for-yogurt-1-decrease." class="level4">
<h4 class="anchored" data-anchor-id="lastly-i-will-calculate-the-market-shares-in-the-market-at-the-time-the-data-were-collected.-then-i-will-simulate-a-price-increase-for-yogurt-1-by-0.10-and-use-the-fitted-model-to-predict-the-choice-probabilities-pyx-for-each-consumer-and-each-product.-this-will-result-in-a-matrix-of-n-estimated-choice-probabilities.-by-taking-the-column-averages-i-will-determine-the-new-expected-market-shares-resulting-from-the-0.10-price-increase-to-yogurt-1-and-assess-whether-the-market-shares-for-yogurt-1-decrease.">Lastly, I will calculate the market shares in the market at the time the data were collected. Then, I will simulate a price increase for yogurt 1 by $0.10 and use the fitted model to predict the choice probabilities ( p(y|x) ) for each consumer and each product. This will result in a matrix of ( N ) estimated choice probabilities. By taking the column averages, I will determine the new expected market shares resulting from the $0.10 price increase to yogurt 1 and assess whether the market shares for yogurt 1 decrease.</h4>
</section>
<section id="lets-calculate-the-market-shares-using-the-original-data-and-then-simulate-a-0.10-price-increase-for-yogurt-1-predicting-the-new-market-shares." class="level4">
<h4 class="anchored" data-anchor-id="lets-calculate-the-market-shares-using-the-original-data-and-then-simulate-a-0.10-price-increase-for-yogurt-1-predicting-the-new-market-shares.">Let’s calculate the market shares using the original data and then simulate a $0.10 price increase for yogurt 1, predicting the new market shares.</h4>
<section id="fit-a-multinomial-logistic-regression-model" class="level5">
<h5 class="anchored" data-anchor-id="fit-a-multinomial-logistic-regression-model">1. Fit a multinomial logistic regression model</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mnl_model <span class="ot">&lt;-</span> <span class="fu">multinom</span>(choice <span class="sc">~</span> price <span class="sc">+</span> featured <span class="sc">+</span> is_brand1 <span class="sc">+</span> is_brand2 <span class="sc">+</span> is_brand3,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> yogurt_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  7 (6 variable)
initial  value 6737.390595 
iter  10 value 4645.900837
final  value 4645.881290 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mnl_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = choice ~ price + featured + is_brand1 + is_brand2 + 
    is_brand3, data = yogurt_long)

Coefficients:
                 Values  Std. Err.
(Intercept)   1.2833567 0.17291188
price       -31.9813620 2.08943937
featured      0.4711846 0.11907591
is_brand1     1.4180774 0.08857565
is_brand2     0.9013131 0.06479672
is_brand3    -3.1409240 0.14229974

Residual Deviance: 9291.763 
AIC: 9303.763 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">summary</span>(mnl_model)<span class="sc">$</span>coefficients</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>standard_errors <span class="ot">&lt;-</span> <span class="fu">summary</span>(mnl_model)<span class="sc">$</span>standard.errors</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>z_values <span class="ot">&lt;-</span> coefficients <span class="sc">/</span> standard_errors</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_values)))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>p_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)        price     featured    is_brand1    is_brand2    is_brand3 
1.152411e-13 0.000000e+00 7.589362e-05 0.000000e+00 0.000000e+00 0.000000e+00 </code></pre>
</div>
</div>
</section>
<section id="model-summary" class="level5">
<h5 class="anchored" data-anchor-id="model-summary">Model Summary:</h5>
<ul>
<li>The model predicts choice based on independent variables: price, featured, and dummy variables for brand presence (is_brand1, is_brand2, is_brand3).</li>
<li>The Residual Deviance is 9291.763, which may be assessed against degrees of freedom to determine goodness-of-fit.</li>
<li>The Akaike Information Criterion (AIC) value is 9303.763, which provides a measure for comparing models (lower values are generally preferred).</li>
</ul>
</section>
<section id="coefficients" class="level5">
<h5 class="anchored" data-anchor-id="coefficients">Coefficients:</h5>
<ul>
<li>Price: The coefficient for price is -31.9813620 with a standard error of 2.08943937. This indicates a significant negative effect on the choice probability as the p-value is virtually zero. With each unit increase in price, the log-odds of choosing the product decreases substantially.</li>
<li>Featured: The featured variable has a coefficient of 0.4711846 (std. err. 0.11907591), showing a positive association with the choice probability.</li>
</ul>
</section>
<section id="brand-variables" class="level5">
<h5 class="anchored" data-anchor-id="brand-variables">Brand Variables:</h5>
<ul>
<li>is_brand1: Has a positive coefficient of 1.4180774 (std. err. 0.08857565), indicating this brand is positively associated with choice.</li>
<li>is_brand2: Also positive with a coefficient of 0.9013131 (std. err. 0.06479672), suggesting it’s favored as well but less so than is_brand1.</li>
<li>is_brand3: Has a negative coefficient of -3.1409240 (std. err. 0.14229974), implying a strong negative impact on the choice probability.</li>
</ul>
</section>
<section id="statistical-significance" class="level5">
<h5 class="anchored" data-anchor-id="statistical-significance">Statistical Significance:</h5>
<ul>
<li>All variables in the model show p-values significantly smaller than 0.05, indicating that they are statistically significant predictors of choice.</li>
</ul>
</section>
<section id="interpretation-2" class="level5">
<h5 class="anchored" data-anchor-id="interpretation-2">Interpretation:</h5>
<p>Given the statistical significance of all coefficients and assuming that the residuals analysis, diagnostics, and validation of model assumptions hold up to scrutiny (which are steps not shown here), this model appears to be robust for the data at hand. The sign and size of the coefficients suggest practical implications on how price and brand presence influence choice probabilities.</p>
</section>
</section>
<section id="calculate-market-shares-with-original-data" class="level4">
<h4 class="anchored" data-anchor-id="calculate-market-shares-with-original-data">2. Calculate Market Shares with Original Data:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>predict_probs <span class="ot">&lt;-</span> <span class="cf">function</span>(model, data) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, data, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.vector</span>(probs)) {</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    probs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(probs, <span class="at">nrow =</span> <span class="fu">length</span>(probs)<span class="sc">/</span><span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(probs)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>predicted_probs_original <span class="ot">&lt;-</span> <span class="fu">predict_probs</span>(mnl_model, yogurt_long)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(predicted_probs_original)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.matrix</span>(predicted_probs_original)) {</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  original_shares <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(predicted_probs_original)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Original Market Shares:"</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(original_shares)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"predicted_probs_original is not a matrix."</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>custom_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Yogurt 2"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>, <span class="st">"Yogurt 1"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>, <span class="st">"Yogurt 4"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>, <span class="st">"Yogurt 3"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>yogurt_shares <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Yogurt, <span class="sc">-</span>MarketShare), <span class="at">y =</span> MarketShare, <span class="at">fill =</span> Yogurt)) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, MarketShare)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> custom_colors, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Market Shares for Yogurt Products before Increasing the Price by $0.1"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Market Share (%)"</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw3_questions_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="market-shares-for-yogurt-products" class="level5">
<h5 class="anchored" data-anchor-id="market-shares-for-yogurt-products">Market Shares for Yogurt Products</h5>
<ul>
<li>Yogurt 2: 40.12%</li>
<li>Yogurt 1: 34.20%</li>
<li>Yogurt 4: 22.76%</li>
<li>Yogurt 3: 2.92%</li>
</ul>
</section>
</section>
<section id="simulate-a-price-increase-for-yogurt-1" class="level4">
<h4 class="anchored" data-anchor-id="simulate-a-price-increase-for-yogurt-1">3. Simulate a Price Increase for Yogurt 1:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate the price increase by $0.10 for yogurt 1</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>yogurt_long_simulated <span class="ot">&lt;-</span> yogurt_long</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>yogurt_long_simulated<span class="sc">$</span>price[yogurt_long_simulated<span class="sc">$</span>is_brand1 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> yogurt_long_simulated<span class="sc">$</span>price[yogurt_long_simulated<span class="sc">$</span>is_brand1 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.10</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the predicted probabilities with the simulated data</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>predicted_probs_new <span class="ot">&lt;-</span> <span class="fu">predict_probs</span>(mnl_model, yogurt_long_simulated)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>new_shares <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(predicted_probs_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>custom_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Yogurt 1"</span> <span class="ot">=</span> <span class="st">"#FFCCCB"</span>, <span class="st">"Yogurt 2"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>, <span class="st">"Yogurt 3"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>, <span class="st">"Yogurt 4"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>yogurt_shares_2 <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Yogurt, <span class="sc">-</span>MarketShare), <span class="at">y =</span> MarketShare, <span class="at">fill =</span> Yogurt)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, MarketShare)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> custom_colors, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Market Shares for Yogurt Products after Increasing the Price by $0.1"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Market Share (%)"</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw3_questions_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="results" class="level4">
<h4 class="anchored" data-anchor-id="results">Results</h4>
<p>Original Market Shares: <br></p>
<ul>
<li><span style="color:green">Yogurt 1: 34.20%</span></li>
<li>Yogurt 2: 40.12%</li>
<li>Yogurt 3: 2.92%</li>
<li>Yogurt 4: 22.76%</li>
</ul>
<p>New Market Shares After Price Increase: <br></p>
<ul>
<li><span style="color:red">Yogurt 1: 2.86%</span></li>
<li>Yogurt 2: 40.12%</li>
<li>Yogurt 3: 2.92%</li>
<li>Yogurt 4: 22.76%</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> data1 <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(MarketShare))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> data2 <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(MarketShare))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the first graph</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Yogurt, <span class="sc">-</span>MarketShare), <span class="at">y =</span> MarketShare, <span class="at">fill =</span> Yogurt <span class="sc">==</span> <span class="st">"Yogurt 1"</span>)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(MarketShare, <span class="st">"%"</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray"</span>, <span class="st">"lightgreen"</span>)) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Market Share (%)"</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the second graph</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Yogurt, <span class="sc">-</span>MarketShare), <span class="at">y =</span> MarketShare, <span class="at">fill =</span> Yogurt <span class="sc">==</span> <span class="st">"Yogurt 1"</span>)) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(MarketShare, <span class="st">"%"</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray"</span>, <span class="st">"#FFCCCB"</span>)) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Market Share (%)"</span>) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the arrow from left to right</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>arrow <span class="ot">&lt;-</span> <span class="fu">linesGrob</span>(<span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"inches"</span>)),</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">"black"</span>), <span class="at">x =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="st">"npc"</span>), <span class="at">y =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">"npc"</span>))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Title text grob</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Market Shares Changes for Yogurt Products by Increasing the Price by $0.1"</span>,</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">12</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>))</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the graphs and the arrow with title</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  title,</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrangeGrob</span>(p1, arrow, p2, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw3_questions_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion-the-market-share-for-yogurt-1-decreased-significantly-from-34.20-to-2.86-after-the-price-increase.-this-indicates-a-substantial-sensitivity-of-consumer-choice-to-the-price-of-yogurt-1." class="level4">
<h4 class="anchored" data-anchor-id="conclusion-the-market-share-for-yogurt-1-decreased-significantly-from-34.20-to-2.86-after-the-price-increase.-this-indicates-a-substantial-sensitivity-of-consumer-choice-to-the-price-of-yogurt-1.">Conclusion: The market share for Yogurt 1 decreased significantly from 34.20% to 2.86% after the price increase. This indicates a substantial sensitivity of consumer choice to the price of Yogurt 1.</h4>
<p><br><br></p>
</section>
</section>
</section>
<section id="final-thoughts-and-conclusion" class="level2">
<h2 class="anchored" data-anchor-id="final-thoughts-and-conclusion">Final Thoughts and Conclusion</h2>
<ul>
<li>In this project, we employed a Multinomial Logistic Regression model to analyze consumer preferences and simulate the impact of price changes on market shares within the yogurt market. Here are the key takeaways and conclusions from our analysis:</li>
</ul>
<section id="model-summary-1" class="level4">
<h4 class="anchored" data-anchor-id="model-summary-1">Model Summary:</h4>
<ul>
<li>The coefficients from the multinomial logistic regression indicate significant predictors of consumer choice.</li>
<li>Price has a strong negative effect on the probability of choosing a product, meaning consumers are price-sensitive.</li>
<li>The presence of product features and brand identifiers also play significant roles in influencing consumer choices.</li>
</ul>
</section>
<section id="market-share-analysis" class="level4">
<h4 class="anchored" data-anchor-id="market-share-analysis">Market Share Analysis:</h4>
<ul>
<li>Using the original data, the market shares were as follows: Yogurt 1 (34.20%), Yogurt 2 (40.12%), Yogurt 3 (2.92%), and Yogurt 4 (22.76%).</li>
<li>This distribution suggests that Yogurt 2 was the most preferred choice among consumers, followed by Yogurt 1, Yogurt 4, and Yogurt 3.</li>
</ul>
</section>
<section id="impact-of-price-increase" class="level4">
<h4 class="anchored" data-anchor-id="impact-of-price-increase">Impact of Price Increase:</h4>
<ul>
<li>When we simulated a $0.10 price increase for Yogurt 1, its market share drastically dropped from 34.20% to 2.86%.</li>
<li>The market shares for the other yogurts remained largely unchanged, indicating that consumers likely switched from Yogurt 1 to other options due to the price increase.</li>
</ul>
</section>
<section id="conclusion-2" class="level4">
<h4 class="anchored" data-anchor-id="conclusion-2">Conclusion</h4>
<ul>
<li>The analysis clearly demonstrates the high price sensitivity of consumers in the yogurt market. A relatively small increase in the price of Yogurt 1 led to a significant decrease in its market share, suggesting that pricing strategies are critical for maintaining market position.</li>
</ul>
</section>
<section id="recommendations" class="level4">
<h4 class="anchored" data-anchor-id="recommendations">Recommendations:</h4>
<ul>
<li>Price Sensitivity Considerations: Companies should carefully consider the impact of price changes on consumer demand. Even small increases can lead to substantial shifts in market shares.</li>
</ul>
</section>
<section id="feature-and-brand-positioning-enhancing-product-features-and-strengthening-brand-identity-can-mitigate-the-negative-impact-of-price-increases.-these-factors-positively-influence-consumer-choices-and-can-help-retain-market-share-even-with-higher-prices." class="level4">
<h4 class="anchored" data-anchor-id="feature-and-brand-positioning-enhancing-product-features-and-strengthening-brand-identity-can-mitigate-the-negative-impact-of-price-increases.-these-factors-positively-influence-consumer-choices-and-can-help-retain-market-share-even-with-higher-prices.">Feature and Brand Positioning: Enhancing product features and strengthening brand identity can mitigate the negative impact of price increases. These factors positively influence consumer choices and can help retain market share even with higher prices.</h4>
</section>
<section id="market-simulations-for-strategic-decisions" class="level4">
<h4 class="anchored" data-anchor-id="market-simulations-for-strategic-decisions">Market Simulations for Strategic Decisions:</h4>
<ul>
<li>Regularly performing market simulations can help predict consumer behavior in response to pricing and other strategic changes. This can provide valuable insights for decision-making and maintaining competitive advantage.</li>
<li>By leveraging advanced analytical techniques like Multinomial Logistic Regression and market simulations, businesses can better understand consumer preferences and optimize their pricing strategies to maximize market share and profitability.</li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>